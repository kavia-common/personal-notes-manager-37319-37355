{"is_source_file": true, "format": "TypeScript", "description": "This file defines a lightweight client-side store for managing notes within a notes application. It handles state management, caching, WebSocket updates, and CRUD operations for notes.", "external_files": ["./api", "./types", "./ws"], "external_methods": ["APIClient.listNotes", "APIClient.getNote", "APIClient.createNote", "APIClient.patchNote", "APIClient.deleteNote", "connectNotesWebSocket"], "published": ["NotesStore", "NotesQuery", "NotesState"], "classes": [{"name": "NotesStoreImpl", "description": "Implementation of a client-side store managing notes state, including caching, WebSocket updates, and CRUD operations."}], "methods": [{"name": "subscribe", "description": "Subscribe to state changes; returns an unsubscribe function."}, {"name": "getState", "description": "Get a snapshot of the current state."}, {"name": "loadList", "description": "Load list of notes with optional parameters; caches latest page."}, {"name": "loadNote", "description": "Load a specific note by ID, with caching."}, {"name": "create", "description": "Create a new note and update caches."}, {"name": "update", "description": "Update a note by ID and synchronize caches."}, {"name": "remove", "description": "Delete a note and update caches."}, {"name": "toggleFavorite", "description": "Toggle the favorite status of a note with optimistic UI updates."}, {"name": "dispose", "description": "Dispose WebSocket connection and event listeners."}, {"name": "invalidateList", "description": "Invalidate the list cache, optionally preserving query parameters."}, {"name": "cancelInFlight", "description": "Cancel in-flight API calls for list and note fetches."}], "calls": ["APIClient.listNotes", "APIClient.getNote", "APIClient.createNote", "APIClient.patchNote", "APIClient.deleteNote", "connectNotesWebSocket"], "search-terms": ["client-side notes store", "WebSocket cache invalidation", "notes CRUD operations", "in-memory cache for notes", "TypeScript notes management"], "state": 2, "file_id": 11, "knowledge_revision": 36, "git_revision": "", "revision_history": [{"28": ""}, {"32": ""}, {"33": ""}, {"35": ""}, {"36": ""}], "ctags": [{"_type": "tag", "name": "Listener", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^type Listener = () => void;$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "NotesQuery", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^interface NotesQuery {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "NotesState", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^interface NotesState {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "NotesStore", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^export const NotesStore = new NotesStoreImpl();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "NotesStoreImpl", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^class NotesStoreImpl {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "aborted", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const aborted = e?.code === 'AbortError' || \\/aborted|abort\\/i.test(e?.message || '');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "currentFav", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const currentFav = fromSelected?.favorite ?? fromList?.favorite ?? false;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "currentParams", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const currentParams = this.state.listParams;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "deletedId", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const deletedId = detail?.payload?.id;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "detail", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const detail = (e as CustomEvent).detail as { type?: string; payload?: any } | undefined;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "evtType", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const evtType = detail?.type || '';$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "false", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const currentFav = fromSelected?.favorite ?? fromList?.favorite ?? false;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "favorite", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  favorite?: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "fromList", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const currentFav = fromSelected?.favorite ?? fromList?.favorite ?? false;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fromList", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const fromList = this.state.list?.items.find((n) => n.id === id);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fromSelected", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const fromSelected = this.state.selectedId === id ? this.state.selected : undefined;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const aborted = e?.code === 'AbortError' || \\/aborted|abort\\/i.test(e?.message || '');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^        const items = list.items.map((it) =>$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const items = list.items.filter((it) => it.id !== id);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const items = list.items.map((it) => (it.id === id ? updated : it));$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const items = list.items.map((it) =>$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^        const list = this.state.list;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const list = this.state.list;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  list?: Paginated<Note>;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listError", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  listError?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listLoading", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  listLoading: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listParams", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  listParams?: NotesQuery;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listeners", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  private listeners = new Set<Listener>();$/", "language": "TypeScript", "kind": "property", "scope": "NotesStoreImpl", "scopeKind": "class"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const n = await APIClient.getNote(id, { signal: this.noteController.signal });$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const n = await APIClient.createNote(data);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimisticFav", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const optimisticFav = !currentFav;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "page", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  page?: number;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "pageSize", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  pageSize?: number;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "resp", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const resp = await APIClient.listNotes(params, { signal: this.listController.signal });$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "sameQuery", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const sameQuery = JSON.stringify(params) === JSON.stringify(this.state.listParams || {});$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "search", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  search?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "selected", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selected?: Note;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "selectedError", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selectedError?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "selectedId", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const selectedId = this.state.selectedId;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "selectedId", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selectedId?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "selectedLoading", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selectedLoading: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  private state: NotesState = {$/", "language": "TypeScript", "kind": "property", "scope": "NotesStoreImpl", "scopeKind": "class"}, {"_type": "tag", "name": "tag", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  tag?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const updated = await APIClient.patchNote(id, data);$/", "language": "TypeScript", "kind": "constant"}], "hash": "495c2325f4d570bde2a868c03fa5f2f6", "format-version": 4, "code-base-name": "notes_app_frontend", "filename": "notes_app_frontend/src/lib/store.ts", "fields": [{"name": "interface NotesQuery {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "interface NotesState {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "favorite?: boolean;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "list?: Paginated<Note>;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "listError?: string;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "listLoading: boolean;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "listParams?: NotesQuery;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "private listeners = new Set<Listener>();", "scope": "NotesStoreImpl", "scopeKind": "class", "description": "unavailable"}, {"name": "page?: number;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "pageSize?: number;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "search?: string;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "selected?: Note;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "selectedError?: string;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "selectedId?: string;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "selectedLoading: boolean;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "private state: NotesState = {", "scope": "NotesStoreImpl", "scopeKind": "class", "description": "unavailable"}, {"name": "tag?: string;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}]}