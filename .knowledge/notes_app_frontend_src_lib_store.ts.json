{"is_source_file": true, "format": "TypeScript", "description": "This file implements a lightweight in-memory client-side store for managing notes within a front-end application. It provides caching, cache invalidation, optimistic updates, and pub/sub mechanisms for UI updates related to notes listing and individual note details.", "external_files": ["./api", "./types"], "external_methods": ["APIClient.listNotes", "APIClient.getNote", "APIClient.createNote", "APIClient.patchNote", "APIClient.deleteNote"], "published": ["NotesStore", "NotesQuery", "NotesState"], "classes": [{"name": "NotesStoreImpl", "description": "Encapsulates the state management for notes, including loading, caching, updating, deleting, and subscribing to state changes."}], "methods": [{"name": "subscribe", "description": "Subscribes a listener function to state changes. Returns an unsubscribe function."}, {"name": "getState", "description": "Returns a snapshot of the current store state."}, {"name": "setState", "description": "Merges a partial update into the current state and notifies subscribers."}, {"name": "loadList", "description": "Fetches a list of notes with optional query params; uses cache if available and valid."}, {"name": "invalidateList", "description": "Clears the cached list of notes, optionally keeping current query parameters."}, {"name": "loadNote", "description": "Loads a specific note by its ID, with caching."}, {"name": "create", "description": "Creates a new note, updates caches, and sets it as selected."}, {"name": "update", "description": "Updates a note by ID and synchronizes caches."}, {"name": "remove", "description": "Deletes a note by ID and updates caches accordingly."}, {"name": "toggleFavorite", "description": "Optimistically toggles the favorite status of a note, with rollback on failure."}], "calls": ["APIClient.listNotes", "APIClient.getNote", "APIClient.createNote", "APIClient.patchNote", "APIClient.deleteNote"], "search-terms": ["NotesStoreImpl", "loadList", "invalidateList", "loadNote", "toggleFavorite"], "state": 2, "file_id": 11, "knowledge_revision": 28, "git_revision": "", "ctags": [{"_type": "tag", "name": "Listener", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^type Listener = () => void;$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "NotesQuery", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^interface NotesQuery {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "NotesState", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^interface NotesState {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "NotesStore", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^export const NotesStore = new NotesStoreImpl();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "NotesStoreImpl", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^class NotesStoreImpl {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "currentFav", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const currentFav = fromSelected?.favorite ?? fromList?.favorite ?? false;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "false", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const currentFav = fromSelected?.favorite ?? fromList?.favorite ?? false;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "favorite", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  favorite?: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "fromList", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const currentFav = fromSelected?.favorite ?? fromList?.favorite ?? false;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fromList", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const fromList = this.state.list?.items.find((n) => n.id === id);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fromSelected", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const fromSelected = this.state.selectedId === id ? this.state.selected : undefined;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^        const items = list.items.map((it) =>$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const items = list.items.filter((it) => it.id !== id);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const items = list.items.map((it) => (it.id === id ? updated : it));$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const items = list.items.map((it) =>$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^        const list = this.state.list;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const list = this.state.list;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  list?: Paginated<Note>;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listError", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  listError?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listLoading", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  listLoading: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listParams", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  listParams?: NotesQuery;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "listeners", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  private listeners = new Set<Listener>();$/", "language": "TypeScript", "kind": "property", "scope": "NotesStoreImpl", "scopeKind": "class"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const n = await APIClient.getNote(id);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const n = await APIClient.createNote(data);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimisticFav", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const optimisticFav = !currentFav;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "page", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  page?: number;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "pageSize", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  pageSize?: number;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "resp", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^      const resp = await APIClient.listNotes(params);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "sameQuery", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const sameQuery =$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "search", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  search?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "selected", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selected?: Note;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "selectedError", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selectedError?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "selectedId", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selectedId?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "selectedLoading", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  selectedLoading: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "NotesState", "scopeKind": "interface"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  private state: NotesState = {$/", "language": "TypeScript", "kind": "property", "scope": "NotesStoreImpl", "scopeKind": "class"}, {"_type": "tag", "name": "tag", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^  tag?: string;$/", "language": "TypeScript", "kind": "property", "scope": "NotesQuery", "scopeKind": "interface"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/personal-notes-manager-37319-37355/notes_app_frontend/src/lib/store.ts", "pattern": "/^    const updated = await APIClient.patchNote(id, data);$/", "language": "TypeScript", "kind": "constant"}], "hash": "99f9d4c012baab70b43d3cabd22dd8d1", "format-version": 4, "code-base-name": "notes_app_frontend", "filename": "notes_app_frontend/src/lib/store.ts", "fields": [{"name": "interface NotesQuery {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "interface NotesState {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "favorite?: boolean;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "list?: Paginated<Note>;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "listError?: string;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "listLoading: boolean;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "listParams?: NotesQuery;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "private listeners = new Set<Listener>();", "scope": "NotesStoreImpl", "scopeKind": "class", "description": "unavailable"}, {"name": "page?: number;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "pageSize?: number;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "search?: string;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}, {"name": "selected?: Note;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "selectedError?: string;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "selectedId?: string;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "selectedLoading: boolean;", "scope": "NotesState", "scopeKind": "interface", "description": "unavailable"}, {"name": "private state: NotesState = {", "scope": "NotesStoreImpl", "scopeKind": "class", "description": "unavailable"}, {"name": "tag?: string;", "scope": "NotesQuery", "scopeKind": "interface", "description": "unavailable"}], "revision_history": [{"28": ""}]}