---
import Layout from '../../layouts/Layout.astro';
import NotesList from '../../components/NotesList.astro';
import Toasts from '../../components/Toasts.astro';

/**
 * PUBLIC_INTERFACE
 * Notes index page.
 * Displays list/grid of notes backed by API with search, pagination, favorite toggle and delete.
 */
const { searchParams } = Astro.url;
const filter = (searchParams.get('filter') ?? 'all') as 'all' | 'favorites';
const view = (searchParams.get('view') ?? 'list') as 'list' | 'grid';
---

<Layout>
  <Toasts />
  <section>
    <header style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;margin-bottom:16px;">
      <div>
        <h1 style="margin:0;">Notes</h1>
        <p class="text-muted" style="margin:4px 0 0;">Viewing: {filter === 'favorites' ? 'Favorites' : 'All Notes'}</p>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        <a class="btn" style="border-color: var(--color-border);" href="/notes?view=list">List</a>
        <a class="btn" style="border-color: var(--color-border);" href="/notes?view=grid">Grid</a>
        <a class="btn btn-primary" href="/notes/new">New Note</a>
      </div>
    </header>

    <NotesList view={view} filter={filter} />
  </section>
</Layout>
